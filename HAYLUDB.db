--create database HAYLUREALESTATE
--USE HAYLUREALESTATE

CREATE TABLE USERS(
	US_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	US_FNAME VARCHAR(25) NOT NULL,
	US_LNAME VARCHAR(25) NOT NULL,
	US_AGE INT,
	US_SEX VARCHAR(6),
	US_CELLPHONE1 CHAR(17),
	US_CELLPHONE2 CHAR(17),
	US_COUNTRY VARCHAR(25),
	US_CITY VARCHAR(25),
	US_SUBCITY VARCHAR(25),
	US_HOUSENUMBER CHAR(10),
	US_EMAIL VARCHAR(50),
	US_PASSWORD VARCHAR(50),
	CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)

CREATE TABLE APPOINTMENT(
	AP_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	AP_PUROPSE VARCHAR(255),
	AP_SUGESSTION VARCHAR(100),
	AP_APPROVED VARCHAR(4) CHECK(AP_APPROVED = 'TRUE' OR AP_APPROVED='FALSE'),
	AP_TIME TIME,
	AP_DATE DATE
)
ALTER TABLE APPOINTMENT ADD US_ID INT

ALTER TABLE APPOINTMENT 
ADD CONSTRAINT FK_AP FOREIGN KEY (US_ID) REFERENCES USERS(US_ID)

CREATE TABLE ASSIGN_APPOINTMENT(
	US_ID INT,
	AP_ID INT,
	EM_ID INT,
	CONSTRAINT PK_AA PRIMARY KEY(US_ID, AP_ID)
)

ALTER TABLE ASSIGN_APPOINTMENT
ADD CONSTRAINT FK_AAc FOREIGN KEY (AP_ID) REFERENCES APPOINTMENT(AP_ID) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE ASSIGN_APPOINTMENT
ADD CONSTRAINT FK_AAb FOREIGN KEY (US_ID) REFERENCES USERS(US_ID) ON UPDATE CASCADE ON DELETE CASCADE, 

ALTER TABLE ASSIGN_APPOINTMENT
ADD CONSTRAINT FK_AAa FOREIGN KEY (EM_ID) REFERENCES EMPLOYEE(EM_ID) ON UPDATE CASCADE ON DELETE CASCADE, 

CREATE TABLE EMPLOYEE(
	EM_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	EM_FNAME VARCHAR(50),
	EM_LNAME VARCHAR(50),
	EM_DATEOFBIRTH INT,
	EM_SEX VARCHAR(6),
	EM_CELLPHONE1 CHAR(17),
	EM_CELLPHONE2 CHAR(17),
	EM_COUNTRY VARCHAR(25),
	EM_CITY VARCHAR(25),
	EM_SUBCITY VARCHAR(25),
	EM_HOUSENUMBER CHAR(10),
	EM_EMAIL VARCHAR(50),
	EM_PASSWORD VARCHAR(50),
	EM_POSITION VARCHAR(50),
	EM_SALARY FLOAT,
	EM_PICTURE VARCHAR(255),
	EM_STATUS VARCHAR(25),
	EM_QULAIFICATION VARCHAR(50),
	EM_EMERGENCY_CONTACT VARCHAR(20),
	W_ID CHAR(11),
	EM_RATING INT,
	AD_ID CHAR(11),
	CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
ALTER TABLE EMPLOYEE 
ADD CONSTRAINT FK_W FOREIGN KEY W_ID REFERENCES WORKING_TIME(W_ID)  ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE EMPLOYEE
ADD CONSTRAINT FK_AD FOREIGN KEY AD_ID REFERENCES ADMIN(AD_ID)  ON UPDATE CASCADE ON DELETE CASCADE;

CREATE TABLE ADMIN(
	AD_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	AD_FNAME VARCHAR(50),
	AD_LNAME VARCHAR(50),
	AD_DATEOFBIRTH INT,
	AD_SEX VARCHAR(6),
	AD_CELLPHONE1 CHAR(17),
	AD_CELLPHONE2 CHAR(17),
	AD_COUNTRY VARCHAR(25),
	AD_CITY VARCHAR(25),
	AD_SUBCITY VARCHAR(25),
	AD_HOUSENUMBER CHAR(10),
	AD_EMAIL VARCHAR(50),
	AD_PASSWORD VARCHAR(50),
	AD_POSITION VARCHAR(50),
	AD_SALARY FLOAT,
	AD_PICTURE VARCHAR(255),
	AD_STATUS VARCHAR(25),
	AD_QULAIFICATION VARCHAR(50),
	AD_EMERGENCY_CONTACT VARCHAR(20),
	AD_RATING INT,
	CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)

CREATE TABLE CATEGORY(
	CAT_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	CAT_NAME VARCHAR(25),
	CAT_TYPE VARCHAR(25),
	CAT_DESCRIPTION VARCHAR(100),
	CAT_PIC VARCHAR(255)
)

CREATE TABLE PROPERTY(
	PR_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	PR_PIC VARCHAR(255),
	PR_TYPE VARCHAR(50),
	PR_LOCATION VARCHAR(50),
	PR_PRICE FLOAT,
	PR_DESCRIPTION VARCHAR(100),
	PR_SQFT VARCHAR(25),
	PR_YEAROFBUILD DATE,
	PR_FEATURES VARCHAR(50),
	PR_STATUS VARCHAR(10),
	RN_ID INT,
	CAT_ID INT,
	CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)

ALTER TABLE PROPERTY
ADD CONSTRAINT FK_PR FOREIGN KEY (CAT_ID) REFERENCES CATEGORY(CAT_ID);

ALTER TABLE PROPERTY
ADD CONSTRAINT FK_PR_ROOM FOREIGN KEY (RN_ID_ID) REFERENCES ROOM_NUM(CAT_ID);


CREATE TABLE PROPERTY_PIC(
	PP_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	PP_PIC_1 VARCHAR(255),
	PP_PIC_2 VARCHAR(255),
	PP_PIC_3 VARCHAR(255),
	PP_PIC_4 VARCHAR(255),
	PP_PIC_5 VARCHAR(255),
	PP_PIC_6 VARCHAR(255),
	PP_PIC_7 VARCHAR(255),
	PP_PIC_8 VARCHAR(255),
	PR_ID INT,
)
ALTER TABLE PROPERTY_PIC
ADD CONSTRAINT FK_PP FOREIGN KEY (PR_ID) REFERENCES PROPERTY(PR_ID;)

CREATE TABLE ROOM_NUM(
	RN_ID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,,
	RN_SALON INT,
	RN_BEDROOM INT,
	RN_BATHROOM INT,
	RN_KITCHEN INT,
	RN_SERVICE INT,
	PR_ID INT
)
ALTER TABLE ROOM_NUM
ADD CONSTRAINT FK_RN FOREIGN KEY PR_ID REFERENCES PROPERTY(PR_ID)

CREATE TABLE WORKING_TIME(
	WT_ID INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
	EM_ID INT,
	W_TIME TIME,
	W_DATE DATE
)
ALTER TABLE WORKING_TIME
ADD CONSTRAIN FK_EM FOREIGN KEY (EM_ID) REFERENCES EMPLOYEE(EM_ID)